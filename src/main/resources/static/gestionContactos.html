<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion de contactos</title>
    <link rel="stylesheet" href="style.css">
    <!-- Se solicita incluir vistaWeb.js en el head -->
    <script src="vistaWeb.js"></script>
</head>
<body class="page-gestion-contactos">
    <!-- Se solicita incluir utilesVista.js al inicio del body -->
    <script src="utilesVista.js"></script>

    <div class="container">
        <h2>Gestion de contactos</h2>
        <!-- Formulario para crear un contacto -->
        <form id="formCrearContacto">
            <!-- 1. Nombre -->
            <div class="form-group">
                <label for="inputNombre">Nombre:</label>
                <input type="text" id="inputNombre" name="nombre" placeholder="Nombre completo" required />
            </div>
            
            <!-- 2. Teléfono -->
            <div class="form-group">
                <label for="inputTelefono">Teléfono:</label>
                <input type="tel" id="inputTelefono" name="telefono" placeholder="Ej: 099123456"  required />
            </div>
            
            <!-- 3. Tipo de contacto -->
            <div class="form-group">
                <label>Tipo de contacto:</label>
                <div id="divTiposContacto">
                    <!-- Aquí se insertarán dinámicamente los tipos de contacto (radiobuttons) -->
                </div>
            </div>
            
            <!-- 4. Botón -->
            <div class="form-group">
                <button id="btnCrearContacto" type="submit">Crear contacto</button>
            </div>
        </form>
     
        <!-- 5. Cantidad de Contactos -->
        <div id="cantidadContactos">Cantidad de contactos : <span id="cantidad"></span></div> 
        <!-- 6. Lista de contactos del usuario -->
        <div id="contenedorAgenda" class="contactos-lista"></div>  
          
    </div>
      

    <!-- Script con constantes para forms y elementos editables -->
    <script>

        urlIniciarVista="/contactos/vistaConectada";
        // Constantes en camelCase para forms y elementos editables
        const formCrearContacto = document.getElementById('formCrearContacto');
        const inputNombre = document.getElementById('inputNombre');
        const inputTelefono = document.getElementById('inputTelefono');
        const divTiposContacto = document.getElementById('divTiposContacto');
        const btnCrearContacto = document.getElementById('btnCrearContacto');
        const contenedorAgenda = document.getElementById('contenedorAgenda');
        const cantidadContactos = document.getElementById('cantidad');


           
     
        formCrearContacto.addEventListener('submit', crearContacto);
        function crearContacto(event) {
            event.preventDefault(); // Evita el envío tradicional del formulario
            submit("contactos/crearContacto", serializarFormulario("formCrearContacto"));
        } 

       function mostrar_usuarioNoAutenticado(urlDestino){
				window.location.href = urlDestino;
        }

        function mostrar_tiposContacto(tiposContacto){
            // Carga select de tipos de contacto
            divTiposContacto.innerHTML = crearListaDesdeJson({
                    data: tiposContacto,
                    campoMostrar: 'descripcion',
                    multiple : false,
                    mostrarOpcionInicial : true, 
                    id : 'posTipoContacto'
                 });       
        }

         function mostrar_agenda(agenda){
            // Muestra la cantidad de contactos
            cantidadContactos.innerText = agenda.cantidadContactos;
            // Muestra la agenda en el contenedorAgenda
            contenedorAgenda.innerHTML = crearTablaDesdeJson(agenda.contactos);
        }

        async function mostrar_mensaje(mensaje) {
            await mostrarMensaje(mensaje);
        }

         async function mostrar_error(mensaje){
            await mostrarMensaje(mensaje);
        }

         function mostrar_limpiarFormulario() {
            formCrearContacto.reset();
        }
        

       
    </script>

</body>
</html>